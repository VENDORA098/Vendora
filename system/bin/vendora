#!/system/bin/sh

MODDIR="/data/adb/modules/VendoraTweak"

ABI="$(getprop ro.product.cpu.abi)"
ABILIST="$(getprop ro.product.cpu.abilist)"

# Default target
TARGET=""

if [ "$ABI" = "arm64-v8a" ]; then
    TARGET="$MODDIR/kernel_inject_arm64.sh"
elif [ "$ABI" = "armeabi-v7a" ]; then
    # Kalau ada arm64 di abilist â†’ tetap 32
    case "$ABILIST" in
        *arm64-v8a*) TARGET="$MODDIR/kernel_inject_arm32.sh" ;;
        *) TARGET="$MODDIR/kernel_inject_arm32.sh" ;;
    esac
else
    echo "Vendora: ABI tidak dikenal ($ABI), fallback ke arm64" >&2
    TARGET="$MODDIR/kernel_inject_arm64.sh"
fi

if [ ! -x "$TARGET" ]; then
    echo "Vendora: binary tidak ditemukan atau tidak executable: $TARGET" >&2
    exit 127
fi

# Forward semua argumen ke binary ELF
"$TARGET" "$@"